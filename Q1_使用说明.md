# Q1 职位差异度分析 - 散点气泡图使用说明

## 功能概述

Q1散点气泡图是一个交互式可视化工具，用于分析不同城市的职位分布情况。它以职位为基本数据单元，展示了经验要求、薪资水平、招聘人数之间的关系。

## 功能特点

### 1. 数据范围
- 选取20个代表性城市
- 每个城市展示招聘人数排名前200的职位

### 2. 可视化元素
- **X轴**: 经验要求（年）- 将原始经验要求量化为数值
- **Y轴**: 薪资中位数（K）- 计算薪资范围的中位数
- **气泡大小**: 该职位在该城市的招聘人数，气泡越大表示招聘人数越多
- **气泡颜色**: 
  - 职位层级模式：基薪普及（蓝色）、平薪新人（绿色）、优薪技能（黄色）、高薪管理（红色）
  - 行业类别模式：不同行业使用不同颜色

### 3. 交互功能

#### 城市选择
- 使用下拉菜单在20个城市之间切换
- 实时更新视图展示选中城市的职位分布

#### 颜色编码切换
- **职位层级视图**: 按职位的聚类类别着色
  - 基薪普及：基础薪资水平的普及型职位
  - 平薪新人：适合新人的平均薪资职位
  - 优薪技能：需要优秀技能的较高薪资职位
  - 高薪管理：高薪资的管理型职位

- **行业类别视图**: 按职位所属行业着色
  - 可以观察不同行业的薪资和经验要求特点

#### 图例交互
- 点击图例项可以显示/隐藏对应类别的数据点
- 灰色表示该类别已被隐藏

#### 悬浮提示（Tooltip）
鼠标悬浮在任意气泡上时，显示详细信息：
- 职位名称
- 具体薪资范围
- 经验要求
- 招聘人数
- 职位层级
- 行业类别

#### 多选高亮
- 点击气泡可选中该职位
- 支持选择2个或多个职位进行对比
- 选中的职位会在右侧显示列表
- 可以点击"清除选择"按钮取消所有选择
- 选中的数据可以传递给其他视图（雷达图、环状图）进行深入分析

## 使用步骤

### 1. 启动后端服务

```bash
cd /Users/houjunyi/Desktop/Visual
python app.py
```

服务将在 `http://localhost:5001` 启动

### 2. 启动前端应用

```bash
cd /Users/houjunyi/Desktop/Visual/fronted
npm install  # 首次运行需要安装依赖
npm run dev
```

前端应用将在 `http://localhost:5173` 启动（或其他端口）

### 3. 访问Q1标签页

在浏览器中打开前端应用，点击"Q1 职位差异度分析"标签页，即可看到散点气泡图。

## 数据解读指南

### 气泡位置解读
- **左下角**（低经验 + 低薪资）：适合应届生或新人的基础职位
- **右下角**（高经验 + 低薪资）：可能是经验要求高但薪资较低的职位，需要进一步分析
- **左上角**（低经验 + 高薪资）：高薪的入门级职位，通常是紧缺岗位
- **右上角**（高经验 + 高薪资）：资深职位或管理岗位

### 气泡大小解读
- **大气泡**: 该职位招聘需求量大，市场需求旺盛
- **小气泡**: 该职位招聘需求量小，可能是专业性强的岗位

### 颜色分布解读
- 职位层级模式下：
  - 红色区域多：该城市高薪管理型职位多
  - 蓝色区域多：该城市基础职位多
  
- 行业类别模式下：
  - 可以观察某个行业在经验-薪资坐标系中的分布特点
  - 不同颜色的聚集程度反映了行业的多样性

## API 接口

详细的API接口文档请参考：`API_Q1图表接口文档.md`

主要接口：
- `GET /api/q1/cities` - 获取城市列表
- `GET /api/q1/scatter?city={city}` - 获取散点图数据
- `GET /api/q1/job-levels` - 获取职位层级列表
- `GET /api/q1/industries` - 获取行业列表

## 测试

运行测试脚本验证API：

```bash
cd /Users/houjunyi/Desktop/Visual
python test_q1_api.py
```

## 技术架构

### 后端
- **框架**: Flask + Flask-CORS
- **数据库**: MySQL
- **数据处理**: 经验和薪资的数值化转换
- **文件位置**:
  - 路由: `routes/q1_routes.py`
  - 服务: `services/q1_service.py`

### 前端
- **框架**: Vue 3 + Vite
- **图表库**: ECharts
- **组件位置**:
  - API客户端: `fronted/src/api/q1Api.js`
  - 图表组件: `fronted/src/components/charts/ScatterBubbleChart.vue`
  - 标签页: `fronted/src/components/tabs/Q1Tab.vue`

## 注意事项

1. 确保MySQL数据库已启动且包含`data`表
2. 数据库表必须包含以下字段：
   - `city`: 城市名称
   - `job_title`: 职位名称
   - `experience`: 经验要求
   - `salary`: 薪资范围
   - `job_level`: 职位层级
   - `company_type`: 行业类别
   - `is_in_top200`: 是否在前200（0/1）
   - `job_in_city_cnt`: 该职位在该城市的招聘人数

3. 城市数据使用编码格式（如K445, S335等）

## 下一步开发

- [ ] 实现雷达图（展示选中职位的多维度特征）
- [ ] 实现环状图（展示职位分布的汇总信息）
- [ ] 添加城市名称的中文映射
- [ ] 支持导出选中职位数据
- [ ] 添加数据筛选功能（按薪资范围、经验范围等）

## 问题反馈

如遇到问题，请检查：
1. 后端服务是否正常启动
2. 数据库连接是否正常
3. 浏览器控制台是否有错误信息
4. API接口返回的数据格式是否正确

